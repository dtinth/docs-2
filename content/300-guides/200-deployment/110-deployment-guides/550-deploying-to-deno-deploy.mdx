---
title: 'Deploy to Deno Deploy'
metaTitle: 'Deploy to Deno Deploy'
metaDescription: 'Learn how to deploy a TypeScript application to Deno Deploy.'
---

<TopBlock>

Today you'll be building and deploying a simple function to Deno Deploy that uses Prisma to save every request to a PostgreSQL database for inspection later.

This guide covers Prisma Client, Data Proxy, and Deno Deploy. Let's get started!

</TopBlock>

## Prerequisites

- Free [Deno Deploy](https://deno.com/deploy) account
- Free [GitHub](https://github.com/) account
- A PostgreSQL database
- Node.js & NPM installed
- Git installed

## 1. Set up your Application

Open your terminal and navigate to a location of your choice. Run the following commands to set up your application.

```terminal
mkdir prisma-deno-deploy
cd prisma-deno-deploy
deno run -A --unstable npm:prisma init
```

In the generated `prisma/schema.prisma`, add the following schema:

```prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Log {
  id      String @id @default(autoincrement())
  level   Level
  message String
  meta    Json
}

enum Level {
  Info
  Warn
  Error
}
```

This data model will store incoming requests from your application.

In your `.env` file, replace the current placeholder connection string with your PostgreSQL connection string.

## 2. Create the database schema

With the data model created and your database connection configured, you can now create the data model in your database:

```terminal
deno run -A --unstable npm:prisma db push
```
TODO does this already generate?

This will create the `Log` table and `Level` enum:

```
TODO
```

## 3. Generate a Prisma Client

Next, generate a Prisma Client that connects through the [Data Proxy](/data-platform/data-proxy) over HTTP.

```terminal
npx prisma generate --data-proxy
```

## 4. Create your application and test it locally

You now have a database schema and a generated local Prisma Client. You can now create a minimal local Deno application. Create an index.ts with the following content:

```ts
import { serve } from "https://deno.land/std@0.140.0/http/server.ts";
import { PrismaClient } from './generated/client/deno/edge.ts'

const prisma = new PrismaClient({
    log: ['query', 'info', 'warn', 'error'],
  })

async function handler(_req: Request) {
  // TODO Rewrite to write to log
  const users = await prisma.user.findMany()
  const body = JSON.stringify(users, null, 2);

/*
  const { request } = event

  // waitUntil method is used for sending logs, after response is sent
  event.waitUntil(
    prisma.log.create({
      data: {
        level: 'Info',
        message: `${request.method} ${request.url}`,
        meta: {
          headers: JSON.stringify(request.headers),
        },
      },
    }).then()
  )

  return new Response(`request method: ${request.method}!`)
  */

  return new Response(body, {
    headers: { "content-type": "application/json; charset=utf-8" },
  });
}

serve(handler);
```

You cannot execute this script yet, because you lack the credentials for Data Proxy that let you use this Client with your database. In the next section, you will resolve this.

## 5. Create a repository and push to GitHub

To prepare for the steps ahead, [create a private repository](https://github.com/new) on GitHub.

![Create a private repository](./550-01-create-repo.png)

Next, initialize your repository, then push your changes to GitHub.

```terminal
git init -b main
git remote add origin https://github.com/<username>/prisma-deno-deploy
git add .
git commit -m "initial commit"
git push -u origin main
```

You're ready to import your project into the Prisma Data Platform.

## 6. Import your Project into the Prisma Data Platform

The next step is to sign up for Prisma's [Data Proxy](/data-platform/data-proxy).

1. Sign up for a free [Prisma Data Platform account](https://cloud.prisma.io/).
   <Admonition type="info">
   
   **Note**<br /><br />
   You need a GitHub account to sign up for the Prisma Data Platform.
   </Admonition>

   ![Signup for Prisma Data Platform](./450-02-signup-pdp.png)

2. Click **New Project** and then select **Import a Prisma repository**.
3. Fill in the repository and project details, and click **Next**.

   <!-- TODO redo -->
   ![Import a Project](./450-03-import-project.png)

4. Connect the Prisma Data Platform to your database and set up the Data Proxy:
   1. Paste your PostgreSQL connection string.
   1. Under **Location**, select a Data Proxy location that is geographically close to your database location.
   1. Click **Create Project** to test the connection and set up the Data Proxy.
      
   You are greeted with a new connection string that starts with `prisma://`. 
5. Copy the `prisma://` connection string to your clipboard.

   <!-- TODO redo -->
   ![Data Proxy Page](./450-05-data-proxy.png)


## 7. Set the Data Proxy Connection string in your environment

With the Data Proxy connection string known, you can replace the direct PostgreSQL connection string that you used to create the database schema: 

- Add the Data Proxy connection string to your local environment `.env` file.

   ```diff file=.env
   - DATABASE_URL = "TODO PostgreSQL placeholder"
   + DATABASE_URL = "prisma://aws-us-east-1.prisma-data.com/?api_key=•••••••••••••••••"
   ```

You are now ready to test your script locally.

## 8. Test your script locally

Execute your script locally:

```terminal
deno run -A ./index.ts
```

Now you can open a browser to TODO and it will write your request to the database.

TODO WHat does it output?

Refresh the page a couple times to verify that it's working. Now if you click on the **Data Browser** tab on your Prisma Cloud project, you should see `Info` logs written to your database.

![Prisma Data Browser](./450-06-data-browser.png)

It's working locally!

## 9. Deploy to Deno Deploy

- https://dash.deno.com/new
- Select repo
- Branch
- Maybe update project name
- Click TODO button
- See browser window showing same as locally

Visit your deployment URL and you'll again see:

```
request method: GET!
```

You're all set! You've successfully deployed a Deno application written in TypeScript that uses Prisma to talk to your PostgreSQL database.

Give yourself a pat on the back, you deserve it!
